# Relatório de Implementação do Padrão Adapter

## 1. Padrão Adapter (Estrutural)

O padrão **Adapter** foi implementado para permitir que a interface de uma classe existente (`Adaptee`) seja usada como outra interface (`Target`) que o cliente espera.

### 1.1. Contexto de Aplicação: Adaptação do Ranking

O padrão foi aplicado na página `src/pages/Dashboard.tsx` para exibir um ranking global. O sistema simula a existência de uma fonte de dados legada (`LegacyScore`) com nomes de campos e códigos de nível diferentes do que a interface de usuário moderna (`LeaderboardEntry`) espera.

### 1.2. Estrutura da Implementação

A implementação foi realizada no arquivo `src/lib/LeaderboardAdapter.ts`.

| Elemento do Padrão | Classe/Interface | Descrição |
| :--- | :--- | :--- |
| **Target** | `interface LeaderboardEntry` | A interface que o componente de ranking no `Dashboard.tsx` espera (e.g., `userName`, `totalPoints`, `ecoLevel`). |
| **Adaptee** | `interface LegacyScore` | A estrutura de dados legada que precisa ser adaptada (e.g., `user_name`, `score_value`, `level_code`). |
| **Adapter** | `class LeaderboardAdapter` | Contém o `Adaptee` e implementa a lógica de conversão, incluindo mapeamento de códigos de nível e ordenação. |
| **Client** | `Dashboard.tsx` | Utiliza o `LeaderboardAdapter` para obter os dados no formato `Target` e exibi-los. |

### 1.3. Diagrama de Classes

O diagrama a seguir ilustra a estrutura do padrão Adapter aplicada à adaptação do ranking:

![Modelagem do Padrão Builder para Registro de Consumo](./assets/adapter.jpeg)


*   **LegacyData (Adaptee):** Representa a interface `LegacyScore`.
*   **ComponentData (Target):** Representa a interface `LeaderboardEntry` que o componente `Dashboard.tsx` espera.
*   **InputAdapter (Adapter):** Representa a classe `LeaderboardAdapter` que realiza a conversão.

### 1.4. Código Fonte (`src/lib/LeaderboardAdapter.ts`)

O código abaixo define a estrutura do padrão Adapter:

\`\`\`typescript
// 1. Target Interface (Interface que o cliente espera)
export interface LeaderboardEntry {
  rank: number;
  userName: string;
  totalPoints: number;
  ecoLevel: string;
}

// 2. Adaptee (Classe ou objeto que precisa ser adaptado)
interface LegacyScore {
  id: number;
  user_name: string;
  score_value: number;
  level_code: string;
}

// 3. Adapter
export class LeaderboardAdapter {
  private adaptee: LegacyScore[];

  constructor(legacyScores: LegacyScore[]) {
    this.adaptee = legacyScores;
  }

  // Função: O método de adaptação que converte o Adaptee para o Target.
  public getAdaptedLeaderboard(): LeaderboardEntry[] {
    // 1. Ordenar por score (pontuação) - Lógica de adaptação
    const sortedScores = [...this.adaptee].sort((a, b) => b.score_value - a.score_value);

    // 2. Mapear e adaptar para a nova interface
    return sortedScores.map((score, index) => ({
      rank: index + 1,
      userName: score.user_name,
      totalPoints: score.score_value,
      ecoLevel: this.mapLevelCodeToEcoLevel(score.level_code), // Mapeamento de código
    }));
  }

  // Função: Lógica de conversão de código de nível para nome de nível.
  private mapLevelCodeToEcoLevel(code: string): string {
    switch (code) {
      case 'B':
        return 'Broto';
      case 'F':
        return 'Folha';
      case 'A':
        return 'Árvore';
      case 'E':
        return 'Ecocampeão';
      default:
        return 'Semente';
    }
  }
}
\`\`\`

### 1.5. Cliente (Dashboard.tsx)

O componente `Dashboard.tsx` atua como o **Cliente**, utilizando o `LeaderboardAdapter` para obter os dados no formato `Target` e exibi-los:

\`\`\`typescript
// Trecho de src/pages/Dashboard.tsx

// Dados simulados no formato legado (Adaptee)
const leaderboardData: any = [
  { id: 1, user_name: 'Alice', score_value: 450, level_code: 'E' },
  { id: 2, user_name: 'Bob', score_value: 300, level_code: 'A' },
  // ...
];

// Criação do Adapter e chamada do método de adaptação
const adapter = new LeaderboardAdapter(leaderboardData);
const leaderboard: LeaderboardEntry[] = adapter.getAdaptedLeaderboard();

// O componente usa a variável 'leaderboard' (Target) para renderizar o ranking
// ...
{leaderboard.map((entry) => (
  <div key={entry.rank}>
    <p>{entry.userName}</p>
    <p>{entry.totalPoints}</p>
    <p>{entry.ecoLevel}</p>
  </div>
))}
// ...
\`\`\`

### 1.6. Benefícios

*   **Reutilização de Código:** Permite o uso de dados legados (`LegacyScore`) sem a necessidade de modificar a fonte de dados original ou o componente `Dashboard.tsx`.
*   **Separação de Preocupações:** A lógica de conversão (adaptação) é isolada na classe `LeaderboardAdapter`, mantendo o componente `Dashboard.tsx` focado apenas na apresentação dos dados.
*   **Flexibilidade:** Facilita a substituição da fonte de dados legada no futuro, bastando criar um novo Adapter para a nova fonte.

**Arquivos Envolvidos:**
*   `src/pages/Dashboard.tsx` (Modificado)
*   `src/lib/LeaderboardAdapter.ts` (Criado)
